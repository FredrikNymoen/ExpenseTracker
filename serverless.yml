service: expensetracker-backend-api
frameworkVersion: "4"

provider:
  name: aws
  runtime: nodejs18.x
  region: eu-north-1
  memorySize: 512
  timeout: 15
  environment:
    NEO4J_URI: neo4j+s://fcba4b76.databases.neo4j.io
    NEO4J_USERNAME: neo4j
    NEO4J_PASSWORD: vzM0DzA1Rc09Vd-9iedQ1c7A3SclotUfIJujMsvZI3U
    COGNITO_REGION: eu-north-1
    COGNITO_USER_POOL_ID: eu-north-1_HBZ87LdIS
  httpApi:
    cors: true
  stage: prod

functions:
  api:
    name: expensetracker-backend-api
    handler: backend/handler.lambdaHandler
    events:
      - httpApi:
          method: ANY
          path: /{proxy+}

# Keep package broad enough to include node_modules at repo root,
# but exclude the frontend to reduce size.
package:
  patterns:
    - "backend/**"
    - "!backend/server.js"   # <- excludes server.js
    - "node_modules/**"
    - "package.json"
    - "package-lock.json"
    - "!frontend/**"
    - "!.env*"
    - "!**/*.md"


# deploy: npx serverless deploy